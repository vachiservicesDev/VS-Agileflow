<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>FreeAgilePoker - Real-Time Agile Collaboration Platform</title>
    <meta name="description" content="Spin up ephemeral rooms for agile ceremonies. No sign-ups, no data persistenceâ€”real-time sync. Data vanishes when the session ends." />
    <script>
      (function() {
        function wrapRegistryDefine(registry) {
          if (!registry || registry.__defineGuardInstalled) return;
          var original = registry.define;
          try {
            registry.define = function(name, ctor, opts) {
              try {
                if (!this.get(name)) {
                  return original.call(this, name, ctor, opts);
                }
              } catch (e) {
                if (!(e && (e.name === 'NotSupportedError' || /already been defined/i.test(String(e.message))))) {
                  throw e;
                }
              }
              try { console.warn("Custom element '" + name + "' already defined, skipping"); } catch (_) {}
            };
            registry.__defineGuardInstalled = true;
          } catch (_) {}
        }

        // Guard current registry
        if (window.customElements) {
          wrapRegistryDefine(window.customElements);
        }

        // Also guard the prototype so later polyfills can't bypass
        try {
          var proto = Object.getPrototypeOf(window.customElements);
          if (proto && !proto.__defineGuardInstalled && typeof proto.define === 'function') {
            var originalProtoDefine = proto.define;
            proto.define = function(name, ctor, opts) {
              try {
                if (!this.get(name)) {
                  return originalProtoDefine.call(this, name, ctor, opts);
                }
              } catch (e) {
                if (!(e && (e.name === 'NotSupportedError' || /already been defined/i.test(String(e.message))))) {
                  throw e;
                }
              }
              try { console.warn("Custom element '" + name + "' already defined, skipping"); } catch (_) {}
            };
            proto.__defineGuardInstalled = true;
          }
        } catch (_) {}

        // Periodically re-apply for a short time in case late polyfills replace it
        var attempts = 0;
        var timer = setInterval(function() {
          attempts++;
          if (window.customElements) wrapRegistryDefine(window.customElements);
          if (attempts > 50) clearInterval(timer); // ~5s
        }, 100);
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>